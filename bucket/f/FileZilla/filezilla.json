{
    "##": [
        "The author of FileZilla explicitly prohibits the use of package managers to download files, as this places undue load on their servers.",
        "Consequently, Scoop must not use any FileZilla-related URLs for downloading or automatic updates.",
        "For further information, please refer to the following resources:",
        "- https://github.com/ScoopInstaller/Extras/issues/9179",
        "- https://forum.filezilla-project.org/viewtopic.php?f=1&t=55635&p=192010&hilit=winget#p192010"
    ],
    "version": "3.69.6",
    "description": "Fast and reliable cross-platform FTP, FTPS and SFTP client with lots of useful features and an intuitive graphical user interface.",
    "homepage": "https://filezilla-project.org",
    "license": "GPL-2.0-or-later",
    "url": "https://packages.chocolatey.org/filezilla.3.69.6.nupkg",
    "hash": "a067ab6474d606696654fc44487a245d3f2385fa9e64e02bfc00bd0c80be7036",
    "extract_dir": "tools",
    "architecture": {
        "64bit": {
            "pre_install": [
                "Get-ChildItem -Path $dir -Exclude '*64*' -Recurse -File | Remove-Item -Force -ErrorAction SilentlyContinue",
                "Get-ChildItem -Path $dir -Include '*.exe' -Recurse -File | Rename-Item -NewName { $_.Name -replace '.+(?=setup\\.exe)', '' } -Force"
            ]
        },
        "32bit": {
            "pre_install": [
                "Get-ChildItem -Path $dir -Exclude '*32*' -Recurse -File | Remove-Item -Force -ErrorAction SilentlyContinue",
                "Get-ChildItem -Path $dir -Include '*.exe' -Recurse -File | Rename-Item -NewName { $_.Name -replace '.+(?=setup\\.exe)', '' } -Force"
            ]
        }
    },
    "installer": {
        "script": [
            "if (-not (Test-Path -Path \"$dir\\setup.exe\" -PathType Leaf)) { abort \"`n[ERROR]  'setup.exe' not found in '$dir'.\" }",
            "Expand-7zipArchive -Path \"$dir\\setup.exe\" -Switches '-xr!$* -xr!unins*' -Removal",
            "[xml]$xml = Get-Content -Path \"$dir\\docs\\fzdefaults.xml.example\" -Encoding utf8",
            "$comments = $xml.ChildNodes | Where-Object { $_.NodeType.ToString() -eq 'Comment' }",
            "$comments | ForEach-Object -Process { $_.ParentNode.RemoveChild($_) | Out-Null }",
            "$xml.SelectSingleNode('//Setting[@name=''Disable update check'']').InnerText = '1'",
            "$xml.SelectSingleNode('//Setting[@name=''Cache directory'']').InnerText = 'data\\cache'",
            "$xml.SelectSingleNode('//Setting[@name=''Config Location'']').InnerText = 'data\\config'",
            "$xml.Save(\"$dir\\fzdefaults.xml\")"
        ]
    },
    "bin": "filezilla.exe",
    "shortcuts": [
        [
            "filezilla.exe",
            "FileZilla"
        ]
    ],
    "persist": "data",
    "checkver": {
        "url": "https://community.chocolatey.org/packages/filezilla",
        "script": [
            "$version_sort = { [version]$_.Groups['version'].Value }",
            "$version_regex = 'FileZilla\\s*<span>(?<version>[\\d.]+)<'",
            "$versions = [regex]::Matches($page, $version_regex) | Sort-Object -Property $version_sort -Descending |",
            "        ForEach-Object -Process { $_.Groups['version'].Value }",
            "foreach ($version in $versions) {",
            "    $version_detail_url = 'https://community.chocolatey.org/packages/filezilla/{0}' -f $version",
            "    $response = Invoke-WebRequest -Uri $version_detail_url -UseBasicParsing -ErrorAction Stop",
            "    if ($response.Content -match '>tools\\\\FileZilla') { Write-Output $version; break }",
            "}"
        ],
        "regex": "([\\d.]+)"
    },
    "autoupdate": {
        "url": "https://packages.chocolatey.org/filezilla.$version.nupkg",
        "hash": {
            "url": "https://community.chocolatey.org/packages/filezilla/$version",
            "regex": "$sha256.+?$basename"
        }
    }
}

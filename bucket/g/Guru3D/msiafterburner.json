{
    "version": "4.6.6",
    "description": "Overclocking utility for graphics cards. Main features include GPU/Shader/Memory clock adjustment, advanced fan speed and GPU voltage control.",
    "homepage": "https://www.msi.com/Landing/afterburner/graphics-cards",
    "license": {
        "identifier": "Freeware",
        "url": "https://www.msi.com/page/website-terms-of-use"
    },
    "suggest": {
        "FurMark": "extras/furmark",
        "MSI Kombustor": "extras/msikombustor",
        "RivaTuner Statistics Server": "extras/rtss",
        "Microsoft Visual C++ 2015-2022 Redistributable": "extras/vcredist2022"
    },
    "url": "https://ftp.nluug.nl/pub/games/PC/guru3d/afterburner/%5BGuru3D%5D-MSIAfterburnerSetup466Build16757.zip#/dl.7z_",
    "hash": "348e9690a638d84e30e32e9c7c2dd7aad9fd82d71eced1942c04c4c5620b0e1e",
    "installer": {
        "script": [
            "Expand-7zipArchive -Path \"$dir\\$fname\" -DestinationPath \"$dir\\tmp\" -Removal",
            "$installer_file = Get-ChildItem -Path \"$dir\\tmp\" -Filter '*.exe' -File | ForEach-Object -MemberName FullName",
            "Expand-7zipArchive -Path $installer_file -Switches '-xr!$* -xr!unins* -x!Redist' -Removal",
            "Remove-Item -Path \"$dir\\tmp\" -Recurse -Force -ErrorAction SilentlyContinue"
        ]
    },
    "bin": "MSIAfterburner.exe",
    "shortcuts": [
        [
            "MSIAfterburner.exe",
            "MSI Afterburner"
        ]
    ],
    "persist": "Profiles",
    "checkver": {
        "script": [
            "$package_url = 'https://api.github.com/repositories/197275551/contents/manifests/g/Guru3D/Afterburner'",
            "$first_letter, $publisher, $package = $package_url.Split('/') | Select-Object -Last 3",
            "$package_page = Invoke-RestMethod -Uri $package_url -Method Get -ErrorAction Stop",
            "$path_segments = $package_page | Where-Object { $_.type -eq 'dir' -and $_.name -match '^[\\d.]+$' } |",
            "        Sort-Object -Property { [version]$_.name } -Descending | ForEach-Object -MemberName name",
            "foreach ($path_segment in $path_segments) {",
            "    $manifest_url = \"$package_url/{2}/{0}.{1}.installer.yaml\" -f $publisher, $package, $path_segment",
            "    $manifest_info = Invoke-RestMethod -Uri $manifest_url -Headers @{ 'Accept' = 'application/vnd.github.v3.raw' } -ErrorAction Stop",
            "    if ($null -ne $manifest_info -and $manifest_info -match 'InstallerUrl:.+/(?<package>[^/]+\\.zip)') {",
            "        Write-Output \"$path_segment, $([System.Net.WebUtility]::UrlEncode($Matches['package']))\"",
            "        break",
            "    }",
            "}"
        ],
        "regex": "([\\d.]+), (?<name>[^\\s]+)"
    },
    "autoupdate": {
        "url": "https://ftp.nluug.nl/pub/games/PC/guru3d/afterburner/$matchName#/dl.7z_",
        "hash": {
            "url": "https://raw.githubusercontent.com/microsoft/winget-pkgs/HEAD/manifests/g/Guru3D/Afterburner/$version/Guru3D.Afterburner.installer.yaml",
            "regex": "(?s)$basename.+?$sha256"
        }
    }
}

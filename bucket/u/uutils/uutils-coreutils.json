{
    "version": "0.6.0",
    "description": "A cross-platform Rust reimplementation of GNU coreutils (binaries compiled with MSVC), with some options or behaviors potentially differing from GNU coreutils.",
    "homepage": "https://uutils.github.io/coreutils/",
    "license": {
        "identifier": "MIT",
        "url": "https://github.com/uutils/coreutils/blob/HEAD/LICENSE"
    },
    "suggest": {
        "Microsoft Visual C++ 2015-2022 Redistributable": "extras/vcredist2022"
    },
    "architecture": {
        "64bit": {
            "url": "https://github.com/uutils/coreutils/releases/download/0.6.0/coreutils-0.6.0-x86_64-pc-windows-msvc.zip",
            "hash": "f223058a51e8a2a4b92d9f1a1b2954f7a02b6d0f42e4a7e0413fcdb93be2e287"
        },
        "32bit": {
            "url": "https://github.com/uutils/coreutils/releases/download/0.6.0/coreutils-0.6.0-i686-pc-windows-msvc.zip",
            "hash": "4b95738775de79250af2ce4f1ca2ed88a31b37910b87b2b6f9f317755c9c1240"
        },
        "arm64": {
            "url": "https://github.com/uutils/coreutils/releases/download/0.6.0/coreutils-0.6.0-aarch64-pc-windows-msvc.zip",
            "hash": "7183bd5aff648b76517182e50d94819efdaede637650f5b9ad9117c171c4eebf"
        }
    },
    "pre_install": [
        "$current_depth = 0",
        "$max_depth = 5",
        "while ($current_depth -lt $max_depth) {",
        "    $items = Get-ChildItem -Path $dir | Select-Object -First 3",
        "    if ($items.Count -eq 1 -and $items.PSIsContainer) {",
        "        $inner_dir = $items | ForEach-Object -MemberName FullName",
        "        Copy-Item -Path \"$inner_dir\\*\" -Destination $dir -Force -Recurse",
        "        Remove-Item -Path $inner_dir -Recurse -Force -ErrorAction SilentlyContinue",
        "        $current_depth++",
        "    } else { break }",
        "}"
    ],
    "post_install": [
        "$process_info = [System.Diagnostics.ProcessStartInfo]@{",
        "    FileName = \"$dir\\coreutils.exe\"; Arguments = '--list'",
        "    CreateNoWindow = $true; UseShellExecute = $false; RedirectStandardOutput = $true",
        "}",
        "$process = [System.Diagnostics.Process]::Start($process_info)",
        "$stdout_content = $process.StandardOutput.ReadToEnd()",
        "$process.WaitForExit()",
        "Write-Output \"`nCreating shim for 'coreutils'...\"",
        "shim \"$dir\\coreutils.exe\" $global 'coreutils' $null",
        "$stdout_content -split \"`r?`n\" | Where-Object { $_ -match '^\\S' } | ForEach-Object {",
        "    Write-Output \"Creating shim for '$($_.Trim())'...\"",
        "    shim \"$dir\\coreutils.exe\" $global $_.Trim() $_.Trim()",
        "}"
    ],
    "uninstaller": {
        "script": [
            "$process_info = [System.Diagnostics.ProcessStartInfo]@{",
            "    FileName = \"$dir\\coreutils.exe\"; Arguments = '--list'",
            "    CreateNoWindow = $true; UseShellExecute = $false; RedirectStandardOutput = $true",
            "}",
            "$process = [System.Diagnostics.Process]::Start($process_info)",
            "$stdout_content = $process.StandardOutput.ReadToEnd()",
            "$process.WaitForExit()",
            "rm_shim 'coreutils' $(shimdir $global) $app",
            "$stdout_content -split \"`r?`n\" | Where-Object { $_ -match '^\\S' } | ForEach-Object {",
            "    rm_shim $_.Trim() $(shimdir $global) $app",
            "}"
        ]
    },
    "checkver": {
        "github": "https://github.com/uutils/coreutils"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/uutils/coreutils/releases/download/$version/coreutils-$version-x86_64-pc-windows-msvc.zip"
            },
            "32bit": {
                "url": "https://github.com/uutils/coreutils/releases/download/$version/coreutils-$version-i686-pc-windows-msvc.zip"
            },
            "arm64": {
                "url": "https://github.com/uutils/coreutils/releases/download/$version/coreutils-$version-aarch64-pc-windows-msvc.zip"
            }
        }
    }
}

{
    "version": "5.4.913.0",
    "description": "A dynamic mathematics software for education that brings together geometry, algebra, spreadsheets, graphing, statistics and calculus.",
    "homepage": "https://www.geogebra.org",
    "license": {
        "identifier": "Freeware",
        "url": "https://www.geogebra.org/license"
    },
    "notes": [
        "To register file associations, please execute the following command:",
        "- `reg import \"$dir\\register-file-associations.reg\"`"
    ],
    "url": "https://download.geogebra.org/installers/5.4/GeoGebra-Windows-Portable-5-4-913-0.zip",
    "hash": "4d3603433e9c984c5858ddd3a73b645a5e908173c50ea49904b79853ef066efc",
    "extract_dir": "GeoGebra 5.4.913.0",
    "post_install": [
        "$geogebra_dir = $dir -replace '\\\\', '\\\\'",
        "Get-ChildItem -Path \"$bucketsdir\\$bucket\\scripts\\$app\" -Filter '*.reg' -File | ForEach-Object -Process {",
        "    $content = Get-Content -Path $_.FullName -Encoding utf8",
        "    if ($global) { $content = $content -replace 'HKEY_CURRENT_USER', 'HKEY_LOCAL_MACHINE' }",
        "    $content -replace '{{geogebra_dir}}', $geogebra_dir | Set-Content -Path \"$dir\\$($_.Name)\" -Encoding unicode",
        "}"
    ],
    "bin": [
        [
            "GeoGebra.exe",
            "geogebra5"
        ]
    ],
    "shortcuts": [
        [
            "GeoGebra.exe",
            "GeoGebra 5"
        ]
    ],
    "uninstaller": {
        "script": "if ($cmd -eq 'uninstall') { reg import \"$dir\\unregister-file-associations.reg\" *> $null }"
    },
    "checkver": {
        "script": [
            "if ($PSVersionTable.PSVersion -lt [version]::new(7, 0)) { Add-Type -AssemblyName System.Net.Http }",
            "$http_handler = New-Object -TypeName System.Net.Http.HttpClientHandler",
            "$http_handler.AllowAutoRedirect = $true",
            "$client = [System.Net.Http.HttpClient]::new($http_handler)",
            "$package_entry_url = 'https://download.geogebra.org/package/win'",
            "$request = New-Object -TypeName System.Net.Http.HttpRequestMessage -ArgumentList 'HEAD', $package_entry_url",
            "$response = $client.SendAsync($request).Result",
            "$package_name = $response.RequestMessage.RequestUri.AbsoluteUri -replace '.+(?<=/)([^/]+)$', '$1'",
            "$response, $request, $client, $http_handler | Where-Object { $null -ne $_ } | ForEach-Object -Process { $_.Dispose() }",
            "$latest_version = $package_name -replace '[^\\d]+([\\d-]+).+', '$1' -replace '-', '.'",
            "Write-Output $latest_version"
        ],
        "regex": "([\\d.]+)"
    },
    "autoupdate": {
        "url": "https://download.geogebra.org/installers/$majorVersion.$minorVersion/GeoGebra-Windows-Portable-$dashVersion.zip",
        "extract_dir": "GeoGebra $version"
    }
}

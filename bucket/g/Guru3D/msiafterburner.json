{
    "version": "4.6.6",
    "description": "Overclocking utility for graphics cards. Main features include GPU/Shader/Memory clock adjustment, advanced fan speed and GPU voltage control.",
    "homepage": "https://www.msi.com/Landing/afterburner/graphics-cards",
    "license": {
        "identifier": "Freeware",
        "url": "https://www.msi.com/page/website-terms-of-use"
    },
    "suggest": {
        "FurMark": "extras/furmark",
        "MSI Kombustor": "extras/msikombustor",
        "RivaTuner Statistics Server": "extras/rtss",
        "Microsoft Visual C++ 2015-2022 Redistributable": "extras/vcredist2022"
    },
    "url": "https://ftp.nluug.nl/pub/games/PC/guru3d/afterburner/%5BGuru3D%5D-MSIAfterburnerSetup466Build16757.zip#/dl.7z_",
    "hash": "348e9690a638d84e30e32e9c7c2dd7aad9fd82d71eced1942c04c4c5620b0e1e",
    "installer": {
        "script": [
            "Expand-7zipArchive -Path \"$dir\\$fname\" -DestinationPath \"$dir\\tmp\" -Removal",
            "$installer_file = Get-ChildItem -Path \"$dir\\tmp\" -Filter '*.exe' -File | ForEach-Object -MemberName FullName",
            "Expand-7zipArchive -Path $installer_file -DestinationPath $dir -Switches '-xr!$* -xr!unins* -x!Redist' -Removal",
            "Remove-Item -Path \"$dir\\tmp\" -Recurse -Force -ErrorAction SilentlyContinue"
        ]
    },
    "bin": "MSIAfterburner.exe",
    "shortcuts": [
        [
            "MSIAfterburner.exe",
            "MSI Afterburner"
        ]
    ],
    "persist": "Profiles",
    "checkver": {
        "url": "https://www.guru3d.com/download/msi-afterburner-beta-download",
        "script": [
            "$page -match 'aform.*?value=\"(?<aform>[0-9a-f]+)\".*?Download (?<version>[\\d.]+)'",
            "$version = $Matches.version",
            "$body = @{ aform = $Matches.aform }",
            "$response = Invoke-WebRequest -Uri $url -Method Post -Body $body",
            "$response.Content -match 'location=\"(?<redirect_url>https://www.guru3d.com/getdownload/[0-9a-f]+)\"'",
            "$response = if ($PSVersionTable.PSVersion.Major -lt 7.0) {",
            "    Invoke-WebRequest -Uri $Matches.redirect_url -MaximumRedirection 0 -ErrorAction SilentlyContinue",
            "} else {",
            "    Invoke-WebRequest -Uri $Matches.redirect_url -MaximumRedirection 0 -ErrorAction SilentlyContinue -SkipHttpErrorCheck",
            "}",
            "[string]($response.Headers.Location) -match 'https://ftp\\.nluug\\.nl/pub/games/PC/guru3d/(?<file_path>[^/]+?)/(?<file_name>.+)'",
            "Write-Output \"$version $($Matches.file_path)/$([System.Net.WebUtility]::UrlEncode($Matches.file_name))\""
        ],
        "regex": "(?<version>[\\d.]+) (?<file>.+)"
    },
    "autoupdate": {
        "url": "https://ftp.nluug.nl/pub/games/PC/guru3d/$matchFile#/dl.7z_"
    }
}

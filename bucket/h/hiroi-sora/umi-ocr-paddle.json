{
    "version": "2.1.5",
    "homepage": "https://github.com/hiroi-sora/Umi-OCR",
    "description": "A free and open-source batch offline OCR application, featuring the Paddle-OCR engine for optimized performance.",
    "license": {
        "identifier": "MIT",
        "url": "https://github.com/hiroi-sora/Umi-OCR/blob/HEAD/LICENSE"
    },
    "notes": [
        "Due to the specific output behavior of `Umi-OCR.exe`, executing `Umi-OCR <option>` directly in a terminal may not display any output.",
        "To display the corresponding output, use a pipe to forward the result to the console.",
        "In Command Prompt (cmd), execute `Umi-OCR <option> | more` to display the output.",
        "In PowerShell, execute `Umi-OCR <option> | Out-GridView` to display the output in a graphical view.",
        "The Out-GridView cmdlet requires a graphical user interface and is unsupported on Windows Server Core and similar environments.",
        "In such environments, `Write-Output` or `Out-Host` may be used as alternatives when output display is required."
    ],
    "architecture": {
        "64bit": {
            "url": "https://github.com/hiroi-sora/Umi-OCR/releases/download/v2.1.5/Umi-OCR_Paddle_v2.1.5.7z.exe",
            "hash": "abe00248d6e68dda75029739751ad7258f0ecc14d720b19240a844f5341859b2"
        }
    },
    "pre_install": [
        "# Hard links are not applicable here because the application creates a new file instead of modifying the existing one in place.",
        "ensure \"$dir\\UmiOCR-data\" | Out-Null",
        "if ($cmd -eq 'install' -and -not (Test-Path -Path \"$persist_dir\\data\\*\")) { return }",
        "'.settings', '.pre_settings' | ForEach-Object -Process {",
        "    if (Test-Path -Path \"$persist_dir\\data\\$_\" -PathType Leaf) {",
        "        Copy-Item -Path \"$persist_dir\\data\\$_\" -Destination \"$dir\\UmiOCR-data\" -Force",
        "    }",
        "}"
    ],
    "installer": {
        "script": "Expand-7zipArchive -Path \"$dir\\$fname\" -ExtractDir \"Umi-OCR_Paddle_v$version\" -Overwrite 'Skip' -Removal"
    },
    "post_install": [
        "$plugins_dir = \"$dir\\UmiOCR-data\\plugins\"",
        "$original_logs_dir = \"$dir\\UmiOCR-data\\logs.original\"",
        "$original_plugins_dir = \"$dir\\UmiOCR-data\\plugins.original\"",
        "if (Test-Path -Path \"$original_plugins_dir\" -PathType Container) {",
        "    Write-Host \"`nINFO  Removing old bundled plugins from '$plugins_dir'...\" -ForegroundColor DarkGray",
        "    Get-ChildItem -Path $plugins_dir -Filter '*Paddle*' -Directory | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue",
        "    Write-Host \"INFO  Updating bundled plugins to '$plugins_dir'...\" -ForegroundColor DarkGray",
        "    Copy-Item -Path \"$original_plugins_dir\\*\" -Destination $plugins_dir -Force -Recurse",
        "}",
        "$original_logs_dir, $original_plugins_dir | Remove-Item -Recurse -Force -ErrorAction SilentlyContinue"
    ],
    "bin": "Umi-OCR.exe",
    "shortcuts": [
        [
            "Umi-OCR.exe",
            "Umi-OCR"
        ]
    ],
    "persist": [
        [
            "UmiOCR-data\\logs",
            "data\\logs"
        ],
        [
            "UmiOCR-data\\plugins",
            "data\\plugins"
        ]
    ],
    "pre_uninstall": [
        "# Hard links are not applicable here because the application creates a new file instead of modifying the existing one in place.",
        "if ($cmd -eq 'uninstall' -and $purge) { return }",
        "'.settings', '.pre_settings' | ForEach-Object -Process {",
        "    if (Test-Path -Path \"$dir\\UmiOCR-data\\$_\" -PathType Leaf) {",
        "        Copy-Item -Path \"$dir\\UmiOCR-data\\$_\" -Destination \"$persist_dir\\data\" -Force",
        "    }",
        "}"
    ],
    "checkver": "github",
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/hiroi-sora/Umi-OCR/releases/download/v$version/Umi-OCR_Paddle_v$version.7z.exe"
            }
        },
        "hash": {
            "url": "https://github.com/hiroi-sora/Umi-OCR/releases/tag/v$version",
            "regex": "(?s)$basename.+?$sha256"
        }
    }
}

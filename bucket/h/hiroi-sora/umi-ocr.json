{
    "version": "2.1.5",
    "homepage": "https://github.com/hiroi-sora/Umi-OCR",
    "description": "A free and open-source batch offline OCR application, featuring the Rapid-OCR engine for enhanced compatibility.",
    "license": {
        "identifier": "MIT",
        "url": "https://github.com/hiroi-sora/Umi-OCR/blob/HEAD/LICENSE"
    },
    "architecture": {
        "64bit": {
            "url": "https://github.com/hiroi-sora/Umi-OCR/releases/download/v2.1.5/Umi-OCR_Rapid_v2.1.5.7z.exe",
            "hash": "659c55896c32a5e019dc7bde1713d0e5c73186a2c653bed84c4480fa1795b722"
        }
    },
    "pre_install": [
        "# Hard links are not applicable here because the application creates a new file instead of modifying the existing one in place.",
        "ensure \"$dir\\UmiOCR-data\" | Out-Null",
        "if ($cmd -eq 'install' -and -not (Test-Path -Path \"$persist_dir\\data\\*\")) { return }",
        "'.settings', '.pre_settings' | ForEach-Object -Process {",
        "    if (Test-Path -Path \"$persist_dir\\data\\$_\" -PathType Leaf) {",
        "        Copy-Item -Path \"$persist_dir\\data\\$_\" -Destination \"$dir\\UmiOCR-data\\$_\" -Force",
        "    }",
        "}"
    ],
    "installer": {
        "script": "Expand-7zipArchive -Path \"$dir\\$fname\" -ExtractDir \"Umi-OCR_Rapid_v$version\" -Overwrite 'Skip' -Removal"
    },
    "post_install": [
        "$plugins_dir = \"$dir\\UmiOCR-data\\plugins\"",
        "$original_logs_dir = \"$dir\\UmiOCR-data\\logs.original\"",
        "$original_plugins_dir = \"$dir\\UmiOCR-data\\plugins.original\"",
        "if (Test-Path -Path \"$original_plugins_dir\" -PathType Container) {",
        "    Write-Host \"`nINFO  Removing old bundled plugins from '$plugins_dir'...\" -ForegroundColor DarkGray",
        "    Get-ChildItem -Path $plugins_dir -Filter '*Rapid*' -Directory | Remove-Item -Force -Recurse -ErrorAction SilentlyContinue",
        "    Write-Host \"INFO  Updating bundled plugins to '$plugins_dir'...\" -ForegroundColor DarkGray",
        "    Copy-Item -Path \"$original_plugins_dir\\*\" -Destination \"$plugins_dir\" -Force -Recurse",
        "}",
        "$original_logs_dir, $original_plugins_dir | Remove-Item -Recurse -Force -ErrorAction SilentlyContinue"
    ],
    "bin": "Umi-OCR.exe",
    "shortcuts": [
        [
            "Umi-OCR.exe",
            "Umi-OCR"
        ]
    ],
    "persist": [
        [
            "UmiOCR-data\\logs",
            "data\\logs"
        ],
        [
            "UmiOCR-data\\plugins",
            "data\\plugins"
        ]
    ],
    "pre_uninstall": [
        "# Hard links are not applicable here because the application creates a new file instead of modifying the existing one in place.",
        "if ($cmd -eq 'uninstall' -and $purge) { return }",
        "'.settings', '.pre_settings' | ForEach-Object -Process {",
        "    if (Test-Path -Path \"$dir\\UmiOCR-data\\$_\" -PathType Leaf) {",
        "        Copy-Item -Path \"$dir\\UmiOCR-data\\$_\" -Destination \"$persist_dir\\data\\$_\" -Force",
        "    }",
        "}"
    ],
    "checkver": "github",
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/hiroi-sora/Umi-OCR/releases/download/v$version/Umi-OCR_Rapid_v$version.7z.exe"
            }
        },
        "hash": {
            "url": "https://github.com/hiroi-sora/Umi-OCR/releases/tag/v$version",
            "regex": "(?s)$basename.+?$sha256"
        }
    }
}
